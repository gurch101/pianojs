(this["webpackJsonpreact-piano"]=this["webpackJsonpreact-piano"]||[]).push([[0],{154:function(t,e,n){},170:function(t,e,n){"use strict";n.r(e);var a=n(1),c=n.n(a),r=n(7),i=n.n(r),s=(n(86),n(35)),o=n.n(s),u=n(20),l=n(34),m=n(36),k=n(70),d=n(71),f=n(79),h=n(72),p=n(80),y=n(73),v=n(78),x=function(t){var e=t.color,n=t.className;return c.a.createElement("div",{className:"".concat("black"===e?"black-key":"white-key"," ").concat(n||"")})},b=function(t){var e=t.keyClassNames;return c.a.createElement("div",{className:"piano"},c.a.createElement(x,{color:"white",className:e[0]}),c.a.createElement(x,{color:"black",className:e[1]}),c.a.createElement(x,{color:"white",className:e[2]}),Object(u.a)(Array(7)).map((function(t,n){return Object(u.a)(Array(12)).map((function(t,a){return c.a.createElement(x,{color:(r=a+1,r<=5&&r%2===1||r>5&&r%2===0?"white":"black"),className:e[12*n+a+3]});var r}))})),c.a.createElement(x,{color:"white",className:void 0!==e[87]}))},w=(n(153),n(154),n(77)),E=n.n(w),N=n(9),g=n.n(N),O=n(155),T=function(t){return t-21},j=function(t){return t+21},I=function(t,e){return g()({"rh-selected":t.rh,selected:!t.rh,sustain:e>t.ticks})},C=function(t){function e(){var t,n;Object(k.a)(this,e);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(n=Object(f.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(c)))).state={currentTickIndex:-1,midi:{},selectedKeys:{},notes:[]},n.getNotesForTick=function(t){return n.state.notes.filter((function(e){return e.ticks===t||e.ticks<=t&&e.ticks+e.durationTicks>t})).map((function(t){return{rh:t.rh,ticks:t.ticks,key:T(t.midi)}})).reduce((function(e,n){return Object(m.a)({},e,Object(l.a)({},n.key,I(n,t)))}),{})},n.previous=function(){var t=n.state.notes,e=t.findIndex((function(e){return e.ticks===t[n.state.currentTickIndex].ticks}));if(e>0){var a=n.getNotesForTick(t[e-1].ticks);n.setState({currentTickIndex:e-1,selectedKeys:a})}},n.next=function(){var t=n.state.notes,e=0;-1!==n.state.currentTickIndex&&(e=t.findIndex((function(e){return e.ticks>t[n.state.currentTickIndex].ticks})));var a=n.getNotesForTick(t[e].ticks);n.setState({currentTickIndex:e,selectedKeys:a})},n.updatePosition=function(t){var e=n.state.notes;n.setState({currentTickIndex:t,selectedKeys:n.getNotesForTick(e[t].ticks)})},n.play=function(){Object.keys(n.state.selectedKeys).filter((function(t){return n.state.selectedKeys[t].indexOf("sustain")<0})).map((function(t){return j(parseInt(t))})).forEach((function(t){n.piano.play(t)}))},n}return Object(p.a)(e,t),Object(d.a)(e,[{key:"componentDidMount",value:function(){var t,e;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(y.Midi.fromUrl(E.a));case 2:return t=n.sent,(e=[].concat(Object(u.a)(t.tracks[0].notes),Object(u.a)((t.tracks[1]?t.tracks[1].notes:[]).map((function(t){return Object(m.a)({},t,{rh:!0})}))),Object(u.a)((t.tracks[2]?t.tracks[2].notes:[]).map((function(t){return Object(m.a)({},t,{rh:!0})}))))).sort((function(t,e){return t.ticks-e.ticks===0?t.durationTicks-e.durationTicks:t.ticks-e.ticks})),n.next=7,o.a.awrap(O.instrument(new AudioContext,"acoustic_grand_piano"));case 7:this.piano=n.sent,this.setState({midi:t,notes:e});case 9:case"end":return n.stop()}}),null,this)}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("div",{style:{textAlign:"center",marginBottom:"10px"}},c.a.createElement("p",{style:{color:"white"}},this.state.currentTickIndex),c.a.createElement("button",{className:"mr1",onClick:this.previous},"Previous"),c.a.createElement("button",{className:"mr1",onClick:this.next},"Next"),c.a.createElement("button",{onClick:this.play},"Play")),c.a.createElement("div",{style:{width:"50%",margin:"0 auto",marginBottom:"10px"}},c.a.createElement(v.a,{min:0,max:this.state.notes.length-1,onChange:this.updatePosition,value:this.state.currentTickIndex})),c.a.createElement(b,{keyClassNames:this.state.selectedKeys}))}}]),e}(c.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},77:function(t,e,n){t.exports=n.p+"static/media/lacrimosa.a2f5513e.mid"},81:function(t,e,n){t.exports=n(170)},86:function(t,e,n){}},[[81,1,2]]]);
//# sourceMappingURL=main.499bcb08.chunk.js.map