(this["webpackJsonpreact-piano"]=this["webpackJsonpreact-piano"]||[]).push([[0],{157:function(t,e,n){},173:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),c=n(7),i=n.n(c),s=(n(89),n(17)),o=n.n(s),u=n(71),l=n(72),m=n(82),d=n(73),f=n(83),k=n(35),h=n(53),p=n(52),v=n(81),x=n(21),y=function(t){var e=t.color,n=t.className;return r.a.createElement("div",{className:"".concat("black"===e?"black-key":"white-key"," ").concat(n||"")})},b=function(t){var e=t.keyClassNames;return r.a.createElement("div",{className:"piano"},r.a.createElement(y,{color:"white",className:e[0]}),r.a.createElement(y,{color:"black",className:e[1]}),r.a.createElement(y,{color:"white",className:e[2]}),Object(x.a)(Array(7)).map((function(t,n){return Object(x.a)(Array(12)).map((function(t,a){return r.a.createElement(y,{color:(c=a+1,c<=5&&c%2===1||c>5&&c%2===0?"white":"black"),className:e[12*n+a+3]});var c}))})),r.a.createElement(y,{color:"white",className:void 0!==e[87]}))},g=(n(156),n(157),n(9)),w=n.n(g),E=n(77),T=n.n(E),N=n(78),S=n.n(N),j=n(79),C=n.n(j),I=n(80),O=n.n(I),K={"./wheresmymind.mid":T.a,"./rachmaninoff.mid":C.a,"./lacrimosa.mid":S.a,"./hsb.mid":O.a},A=function(t,e){return{rh:e,midi:t.midi,duration:t.duration,time:t.time,ticks:t.ticks,durationTicks:t.durationTicks}},B=function(t){var e,n,a;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=K[t],r.next=3,o.a.awrap(p.Midi.fromUrl(e));case 3:return n=r.sent,(a=[].concat(Object(x.a)(n.tracks[0].notes.map((function(t){return A(t,!1)}))),Object(x.a)((n.tracks[1]?n.tracks[1].notes:[]).map((function(t){return A(t,!0)}))),Object(x.a)((n.tracks[2]?n.tracks[2].notes:[]).map((function(t){return A(t,!0)}))))).sort((function(t,e){return t.ticks-e.ticks===0?t.durationTicks-e.durationTicks:t.ticks-e.ticks})),r.abrupt("return",a);case 7:case"end":return r.stop()}}))},F=n(158),P=function(t){return t-21},J=function(t){return t.reduce((function(t,e){return Object(h.a)({},t,Object(k.a)({},e.key,function(t){return w()({"rh-selected":t.rh,selected:!t.rh,sustain:t.sustain})}(e)))}),{})},M=function(t){function e(){var t,n;Object(u.a)(this,e);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).state={currentTickIndex:-1,currentTick:-1,midi:{},selectedKeys:[],notes:[],currentSong:"./lacrimosa.mid"},n.getNotesForTick=function(t){return n.state.notes.filter((function(e){return e.ticks===t||e.ticks<=t&&e.ticks+e.durationTicks>t})).map((function(e){return Object(h.a)({},e,{rh:e.rh,key:P(e.midi),sustain:e.ticks<t})}))},n.previous=function(){var t=n.state.notes,e=t.findIndex((function(e){return e.ticks===t[n.state.currentTickIndex].ticks}));if(e>0){var a=n.getNotesForTick(t[e-1].ticks);n.setState({currentTick:t[e-1].ticks,currentTickIndex:e-1,selectedKeys:a})}},n.next=function(){var t=n.state.notes,e=0;-1!==n.state.currentTickIndex&&(e=t.findIndex((function(e){return e.ticks>t[n.state.currentTickIndex].ticks})));var a=n.getNotesForTick(t[e].ticks);n.setState({currentTickIndex:e,selectedKeys:a})},n.updatePosition=function(t){var e=n.state.notes;n.setState({currentTickIndex:t,selectedKeys:n.getNotesForTick(e[t].ticks)})},n.play=function(){n.state.selectedKeys.filter((function(t){return!t.sustain})).forEach((function(t){n.piano.play(t.midi,0,{duration:t.duration})}))},n.setCurrentSong=function(t){n.loadSong(t.target.value)},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.loadSong(this.state.currentSong);case 1:case"end":return t.stop()}}),null,this)}},{key:"loadSong",value:function(t){var e,n=this;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(B(t));case 2:return e=a.sent,this.audioContext=new AudioContext,a.next=6,o.a.awrap(F.instrument(this.audioContext,"acoustic_grand_piano"));case 6:this.piano=a.sent,this.setState({currentSong:t,notes:e,currentTickIndex:-1,selectedKeys:[]},(function(){n.next()}));case 8:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center",marginBottom:"10px"}},r.a.createElement("select",{value:this.state.currentSong,onChange:this.setCurrentSong},r.a.createElement("option",{value:"./hsb.mid"},"Heart-Shaped Box"),r.a.createElement("option",{value:"./lacrimosa.mid"},"Lacrimosa"),r.a.createElement("option",{value:"./rachmaninoff.mid"},"Rachmaninoff")),r.a.createElement("p",{style:{color:"white"}},this.state.currentTickIndex),r.a.createElement("button",{className:"mr1",onClick:this.previous},"Previous"),r.a.createElement("button",{className:"mr1",onClick:function(){return t.next()}},"Next"),r.a.createElement("button",{onClick:this.play},"Play")),r.a.createElement("div",{style:{width:"50%",margin:"0 auto",marginBottom:"10px"}},r.a.createElement(v.a,{min:0,max:this.state.notes.length-1,onChange:this.updatePosition,value:this.state.currentTickIndex})),r.a.createElement(b,{keyClassNames:J(this.state.selectedKeys,this.state.currentTick)}))}}]),e}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},77:function(t,e,n){t.exports=n.p+"static/media/wheresmymind.32304232.mid"},78:function(t,e,n){t.exports=n.p+"static/media/lacrimosa.a2f5513e.mid"},79:function(t,e,n){t.exports=n.p+"static/media/rachmaninoff.9302bc1a.mid"},80:function(t,e,n){t.exports=n.p+"static/media/hsb.fa434e16.mid"},84:function(t,e,n){t.exports=n(173)},89:function(t,e,n){}},[[84,1,2]]]);
//# sourceMappingURL=main.1f6e65be.chunk.js.map